<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>modbus2mqtt</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>

<style>
  .header {
    display: flex;
    align-items: center;
    justify-content: flex-start;
  }

  .header img {
    max-height: 100px;
    margin-right: 10px;
    margin-bottom: 20px;
  }
</style>

<body>
  <div class="container mt-4">
    <div class="header d-flex justify-content-between align-items-center">
      <img src="{{ url_for('static', filename='logo.png') }}" alt="Logo">
      <button id="restartButton" class="btn btn-warning">Restart</button>
    </div>

    <ul class="nav nav-tabs" id="configTabs">
      <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#modbus">Modbus</a></li>
      <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#mqtt">MQTT</a></li>
      <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#registers">Registers</a></li>
      <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#ui">UI</a></li>
    </ul>

    <div class="tab-content mt-3">
      <!-- Modbus Tab -->
      <div class="tab-pane fade show active" id="modbus">
        <form id="modbusForm">
          <label>Baud:</label>
          <input class="form-control" name="baud" type="number" value="{{ config.modbus.baud }}">
          <label>Stopbits:</label>
          <input class="form-control" name="stopbits" type="number" value="{{ config.modbus.stopbits }}">
          <label>Bytesize:</label>
          <input class="form-control" name="bytesize" type="number" value="{{ config.modbus.bytesize }}">
          <label>Parity:</label>
          <input class="form-control" name="parity" type="text" value="{{ config.modbus.parity }}">
          <label>Timeout:</label>
          <input class="form-control" name="timeout" type="number" value="{{ config.modbus.timeout }}">
          <label>Device Address:</label>
          <input class="form-control" name="device" type="text" value="{{ config.modbus.device }}">


        </form>
      </div>

      <!-- MQTT Tab -->
      <div class="tab-pane fade" id="mqtt">
        <form id="mqttForm">
          <label>Address:</label>
          <input class="form-control" name="address" value="{{ config.mqtt.address }}">
          <label>Username:</label>
          <input class="form-control" name="username" value="{{ config.mqtt.username }}">
          <label>Password:</label>
          <input class="form-control" type="password" name="password" value="{{ config.mqtt.password }}">
          <label>Prefix:</label>
          <input class="form-control" name="prefix" value="{{ config.mqtt.prefix }}">
        </form>
      </div>

      <!-- Registers Tab -->
      <div class="tab-pane fade" id="registers">
        <div id="registerList"></div>
        <button class="btn btn-primary mt-2" onclick="addRegister()">+ Register</button>
      </div>

      <!-- UI Tab -->
      <div class="tab-pane fade" id="ui">
        <form id="uiForm">
          <div>
            <label>Username:</label><br>
            <input class="form-control" type="text" value="admin" readonly>
          </div>
          <br>
          <div>
            <label>Password:</label><br>
            <input class="form-control" type="password" name="password" type="text" value="{{ config.ui.password }}">
          </div>
        </form>
      </div>

      <button class="btn btn-success mt-4" onclick="saveConfig()">Save Config</button>
    </div>


    <script>
      const initialRegisters = {{ config["registers"] | tojson | safe }};
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="/static/script.js"></script>


    <div class="footer text-center mt-4">
      <p>
        <a href="https://github.com/marcel-domke/modbus2mqtt" target="_blank">GitHub</a>
      </p>
      <p>
        Licensed under the MIT License. See <a href="https://github.com/marcel-domke/modbus2mqtt/blob/main/LICENSE" target="_blank">MIT
          License</a> for more details.
      </p>
    </div>
</body>
</html>
